<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Final Questions - Bug Detective</title>
        <link rel="stylesheet" type="text/css" href="static/explanation.css">
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script type="text/javascript" src="static/logging.js"></script>
        <script type="text/javascript" src="static/propagate_params.js"></script>
    </head>
    <body>
        <div class="content-container">
            <h2>Thank you for participating in our study!</h2>
            <p>Please answer the following questions about your experience with the Bug Detective tutorial sequence:</p>

            <div style="margin-bottom: 15px;">
                <label for="question1" style="display: block; margin-bottom: 5px;">
                    <b>After practicing debugging with the Bug Detective, what do you think is the most important thing to focus on when trying to debug code?</b>
                </label>
                <textarea id="question1" rows="4" style="width: 100%;"></textarea>
            </div>

            <div style="margin-bottom: 15px;">
                <label for="question2" style="display: block; margin-bottom: 5px;">
                    <b>What was the most helpful about the Bug Detective tutorial and how did it help?</b>
                </label>
                <textarea id="question2" rows="4" style="width: 100%;"></textarea>
            </div>

            <div style="margin-bottom: 15px;">
                <label for="question3" style="display: block; margin-bottom: 5px;">
                    <b>What did you find the most confusing about the Bug Detective tutorial?</b>
                </label>
                <textarea id="question3" rows="4" style="width: 100%;"></textarea>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 10px;">
                    <b>How much <u>programming</u> experience do you have?</b>
                </label>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 0.9em;">Very little</span>
                    <div style="display: flex; gap: 15px;border: 1px gray dotted;padding-right: 5px;">
                        <label><input type="radio" name="programming_experience" value="1"> 1</label>
                        <label><input type="radio" name="programming_experience" value="2"> 2</label>
                        <label><input type="radio" name="programming_experience" value="3"> 3</label>
                        <label><input type="radio" name="programming_experience" value="4"> 4</label>
                        <label><input type="radio" name="programming_experience" value="5"> 5</label>
                        <label><input type="radio" name="programming_experience" value="6"> 6</label>
                        <label><input type="radio" name="programming_experience" value="7"> 7</label>
                    </div>
                    <span style="font-size: 0.9em;">I code for a living</span>
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 10px;">
                    <b>How much experience do you have with <u>Python</u>?</b>
                </label>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 0.9em;">Never used it before</span>
                    <div style="display: flex; gap: 15px;border: 1px gray dotted;padding-right: 5px;">
                        <label><input type="radio" name="python_experience" value="1"> 1</label>
                        <label><input type="radio" name="python_experience" value="2"> 2</label>
                        <label><input type="radio" name="python_experience" value="3"> 3</label>
                        <label><input type="radio" name="python_experience" value="4"> 4</label>
                        <label><input type="radio" name="python_experience" value="5"> 5</label>
                        <label><input type="radio" name="python_experience" value="6"> 6</label>
                        <label><input type="radio" name="python_experience" value="7"> 7</label>
                    </div>
                    <span style="font-size: 0.9em;">I am a Python expert</span>
                </div>
            </div>

            <button id="submit_questions" style="width: fit-content;">Submit Answers</button>
        </div>

        <script>
            $(document).ready(function() {
                $('#submit_questions').click(function() {
                    const answers = addIdentifier({
                        important_focus: $('#question1').val(),
                        most_helpful: $('#question2').val(),
                        most_confusing: $('#question3').val(),
                        programming_experience: $('input[name="programming_experience"]:checked').val(),
                        python_experience: $('input[name="python_experience"]:checked').val(),
                    });

                    const urlParams = new URLSearchParams(window.location.search);

                    fetch('/submit_end_questions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(answers)
                    })
                    .then(response => response.json())
                    .then(data => {
                        if(data.status === 'success') {
                            // Redirect to external URL if provided
                            // TODO: make sure the cc is correct
                            const redirectUrl = 'https://app.prolific.com/submissions/complete?cc=C1GZHIJQ';
                            window.location.href = redirectUrl;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
                });
            });
        </script>
    </body>
</html>